jQuery((function(e){var t,i=e.trim(e("#_mytory_slider_image_ids").val()),a=0;function n(){e(".js-preview").html(""),_.each(e("#_mytory_slider_image_ids").val().split(","),(function(t){var i,a=wp.media.attachment(t);i=a.attributes.sizes.hasOwnProperty("thumbnail")?a.attributes.sizes.thumbnail.url:a.attributes.url,e("<img>",{src:i,style:"margin: 0 .5em .3em 0; width: 150px; height: 150px;",title:"편집하려면 사진 변경 버튼을 누르세요."}).appendTo(".js-preview")}))}function s(){e(".js-ing").remove(),e(".js-open-media").addClass("hidden"),e.trim(e("#_mytory_slider_image_ids").val())?e(".js-update-photo").removeClass("hidden"):e(".js-select-photo").removeClass("hidden")}function r(t){var i=_.pluck(t.toJSON(),"id").join(",");e("#_mytory_slider_image_ids").val(i),s(),n()}i?_.each(i.split(","),(function(t,i,r){wp.media.attachment(t).fetch().done((function(){++a===r.length&&(e(".js-open-media").attr("disabled",!1),s(),n())}))})):(s(),e(".js-open-media").attr("disabled",!1)),e(".js-open-media").click((function(){t||((t=wp.media.frames.assisiPhotoFrame=wp.media(function(){var t=[],i={frame:"post",state:"gallery-library",caption:"링크",data:{caption:"링크"}},a=e.trim(e("#_mytory_slider_image_ids").val());return a&&(_.each(a.split(","),(function(e){var i=wp.media.attachment(e);t.push(i)})),i.selection=new wp.media.model.Selection(t,{multiple:!0})),i}())).on("open",(function(){e.trim(e("#_mytory_slider_image_ids").val())&&t.setState("gallery-edit"),e(".describe").attr("placeholder","Link")})),setTimeout((function(){document.querySelector(".media-button-insert").addEventListener("click",(function(){setTimeout((function(){e(".describe").attr("placeholder","Link")}),100)}))}),100),t.on("update",r)),t.open()}))}));